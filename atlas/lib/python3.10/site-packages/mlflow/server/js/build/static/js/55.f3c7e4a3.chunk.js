"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[55],{57596:function(e,t,s){s.r(t),s.d(t,{ModelVersionPage:function(){return he},ModelVersionPageImpl:function(){return ce},default:function(){return me}});var i=s(76998),o=s(89365),r=s(13004),n=s(1797),a=s(89990),l=s(2543),d=s(29037),c=s(3281),u=s(64671),p=s(45901),h=s.n(p),m=s(86288),g=s(34139),f=s(33444),M=s(71146),v=s(99476),b=s(3645),y=s(51391);var D={name:"1yh8glp",styles:"margin-top:-12px"};const A=e=>{const t=(0,m.A)(),s=(0,l.Zp)(),n=(0,i.useRef)((0,f.yk)()),a=(0,i.useRef)((0,f.yk)()),{modelVersion:h}=e,[A,I]=(0,i.useState)(!1),[R,S]=(0,i.useState)(!1),Y=(0,o.wA)(),w=(0,o.d4)((e=>e.entities.modelByName)),N=(0,i.useRef)(),V=()=>{I(!1),S(!1)},E=e=>{S(!1),M.A.logErrorAndNotifyUser(e)},k=(0,i.useCallback)((e=>{Y((0,r.JK)((0,v.pc)(e),5))}),[Y]),C=(0,i.useMemo)((()=>(0,p.debounce)(k,300)),[k]);(0,i.useEffect)((()=>{Y((0,r.JK)())}),[Y]),(0,i.useEffect)((()=>{A&&Y((0,r.JK)())}),[Y,A]);return(0,y.FD)("div",{className:"promote-model-btn-wrapper",children:[(0,y.Y)(c.B,{componentId:"codegen_mlflow_app_src_model-registry_components_promotemodelbutton.tsx_165",className:"promote-model-btn",type:"primary",onClick:()=>{I(!0)},children:(0,y.Y)(g.A,{id:"+RYBrq",defaultMessage:"Promote model"})}),(0,y.Y)(u.M,{title:(0,y.Y)(g.A,{id:"oBjwod",defaultMessage:"Promote {sourceModelName} version {sourceModelVersion}",values:{sourceModelName:h.name,sourceModelVersion:h.version}}),width:640,visible:A,onOk:()=>{N.current.validateFields().then((e=>{S(!0);const t=e[b.BE],i="models:/"+h.name+"/"+h.version;if(t===b.QN){const t=e[b.F3];Y((0,r.eF)(t,n.current)).then((()=>Y((0,r.Ey)(t,i,h.run_id,h.tags,a.current)))).then((e=>{V();const{version:i}=e.value.model_version;s(d.fM.getModelVersionPageRoute(t,i))})).catch(E)}else Y((0,r.Ey)(t,i,h.run_id,h.tags,a.current)).then((e=>{V();const{version:i}=e.value.model_version;s(d.fM.getModelVersionPageRoute(t,i))})).catch(E)}))},okText:t.formatMessage({id:"DCkSC3",defaultMessage:"Promote"}),cancelText:t.formatMessage({id:"0tU5gv",defaultMessage:"Cancel"}),confirmLoading:R,onCancel:()=>{I(!1)},centered:!0,children:(0,y.FD)(y.FK,{children:[(0,y.Y)(c.o.Paragraph,{css:D,children:(0,y.Y)(g.A,{id:"V5cjvM",defaultMessage:"Copy your MLflow models to another registered model for  simple model promotion across environments. For more mature production-grade setups, we recommend setting up automated model training workflows to produce models in controlled environments. <link>Learn more</link>",values:{link:e=>(0,y.Y)(c.o.Link,{href:"https://mlflow.org/docs/latest/model-registry.html#promoting-an-mlflow-model-across-environments",openInNewTab:!0,children:e})}})}),(0,y.Y)(b.xH,{modelByName:w,innerRef:N,onSearchRegisteredModels:C,isCopy:!0})]})})]})};var I=s(82478),R=s(64819),S=s(8704),Y=s(47609),w=s(69578),N=s(44303),V=s(24816);class E extends i.Component{render(){const{toStage:e,innerRef:t}=this.props;return(0,y.Y)(N.A,{ref:t,className:"model-version-update-form",children:e&&w.jI.includes(e)&&(0,y.Y)(N.A.Item,{name:"archiveExistingVersions",initialValue:"true",valuePropName:"checked",preserve:!1,children:(0,y.Y)(S.Sc0,{children:(0,y.FD)(S.paO,{title:(0,w.gL)(e),children:[(0,y.Y)(g.A,{id:"F/EzKI",defaultMessage:"Transition existing {currentStage} model versions to {archivedStage}",values:{currentStage:w.$0[e],archivedStage:w.$0[w.e3.ARCHIVED]}}),"\xa0"]})})})})}}const k=(0,V.Ay)(E);class C extends i.Component{constructor(){super(...arguments),this.state={confirmModalVisible:!1,confirmingActivity:null,handleConfirm:void 0},this.transitionFormRef=i.createRef(),this.handleMenuItemClick=e=>{const{onSelect:t}=this.props;this.setState({confirmModalVisible:!0,confirmingActivity:e,handleConfirm:t&&(()=>{this.setState({confirmModalVisible:!1});const t=Boolean(this.transitionFormRef.current.getFieldValue("archiveExistingVersions"));this.props.onSelect(e,t)})})},this.handleConfirmModalCancel=()=>{this.setState({confirmModalVisible:!1})},this.getNoneCurrentStages=e=>{const t=Object.values(w.e3);return h().remove(t,(t=>t===e)),t}}getMenu(){const{currentStage:e,onSelect:t}=this.props,s=this.getNoneCurrentStages(e);return(0,y.Y)(S.W1t,{onSelect:t,children:s.map((e=>(0,y.FD)(S.W1t.Item,{onClick:()=>this.handleMenuItemClick({type:w.$p.APPLIED_TRANSITION,to_stage:e}),children:[(0,y.Y)(g.A,{id:"UhdPmo",defaultMessage:"Transition to"}),"\xa0\xa0\xa0",(0,y.Y)(Y.A,{}),"\xa0\xa0\xa0",w.$0[e]]},`transition-to-${e}`)))})}renderConfirmModal(){const{confirmModalVisible:e,confirmingActivity:t,handleConfirm:s}=this.state;if(t){const i=(0,y.Y)(k,{innerRef:this.transitionFormRef,toStage:t.to_stage});return(0,y.FD)(u.M,{title:(0,y.Y)(g.A,{id:"Dxwvus",defaultMessage:"Stage Transition"}),visible:e,onOk:s,onCancel:this.handleConfirmModalCancel,okText:(0,y.Y)(g.A,{id:"SAD2Mj",defaultMessage:"OK"}),cancelText:(0,y.Y)(g.A,{id:"XzoBvA",defaultMessage:"Cancel"}),children:[_(t),i]})}return null}render(){const{currentStage:e}=this.props;return(0,y.FD)("span",{children:[(0,y.Y)(S.msM,{overlay:this.getMenu(),trigger:["click"],className:"stage-transition-dropdown",children:(0,y.FD)("span",{children:[w.$0[e],(0,y.Y)(S.D3D,{css:(0,R.AH)({cursor:"pointer",marginLeft:-4},"")})]})}),this.renderConfirmModal()]})}}C.defaultProps={currentStage:w.e3.NONE};const _=e=>e?(0,y.FD)("div",{children:[(0,y.Y)(g.A,{id:"ZYBoeF",defaultMessage:"Transition to"}),"\xa0\xa0\xa0",(0,y.Y)(Y.A,{}),"\xa0\xa0\xa0",w.$0[e.to_stage]]}):null;var x=s(41153),T=s(71949),P=s(41648),F=s(89105),q=s(71109),L=s(74780),$=s(86284),O=s(18509);var U=s(82630),B=s(87004),K=s(16936),z=s(4291),H=s(84948);var j={name:"lkh5er",styles:"display:flex;flex-wrap:wrap;align-items:center"};const G=e=>{let{aliases:t=[],modelEntity:s,version:o,onAliasesModified:r}=e;const{EditAliasesModal:n,showEditAliasesModal:a}=(0,z.o)({model:s||null,onSuccess:r}),l=(0,i.useCallback)((()=>{a(o)}),[a,o]);return(0,y.FD)(y.FK,{children:[n,t.length<1?(0,y.Y)(c.B,{componentId:"codegen_mlflow_app_src_model-registry_components_aliases_modelversionviewaliaseditor.tsx_29",size:"small",type:"link",onClick:l,title:"Add aliases",children:"Add"}):(0,y.FD)("div",{css:j,children:[t.map((e=>(0,y.Y)(H.m,{compact:!0,value:e},e))),(0,y.Y)(c.B,{componentId:"codegen_mlflow_app_src_model-registry_components_aliases_modelversionviewaliaseditor.tsx_37",size:"small",icon:(0,y.Y)(S.R2l,{}),onClick:l,title:"Edit aliases"})]})]})};var W={name:"s5xdrg",styles:"display:flex;align-items:center"},Q={name:"gc6sdx",styles:"padding-left:4px"},X={name:"vw6wts",styles:"margin-top:8px;display:flex;justify-content:flex-end"};class Z extends i.Component{constructor(){super(...arguments),this.state={isDeleteModalVisible:!1,isDeleteModalConfirmLoading:!1,showDescriptionEditor:!1,isTagsRequestPending:!1},this.formRef=i.createRef(),this.handleDeleteConfirm=()=>{const{modelName:e="",modelVersion:t,navigate:s}=this.props,{version:i}=t;this.showConfirmLoading(),this.props.deleteModelVersionApi(e,i).then((()=>{s(d.fM.getModelPageRoute(e))})).catch((e=>{this.hideConfirmLoading(),M.A.logErrorAndNotifyUser(e)}))},this.showDeleteModal=()=>{this.setState({isDeleteModalVisible:!0})},this.hideDeleteModal=()=>{this.setState({isDeleteModalVisible:!1})},this.showConfirmLoading=()=>{this.setState({isDeleteModalConfirmLoading:!0})},this.hideConfirmLoading=()=>{this.setState({isDeleteModalConfirmLoading:!1})},this.handleCancelEditDescription=()=>{this.setState({showDescriptionEditor:!1})},this.handleSubmitEditDescription=e=>this.props.handleEditDescription(e).then((()=>{this.setState({showDescriptionEditor:!1})})),this.startEditingDescription=e=>{e.stopPropagation(),this.setState({showDescriptionEditor:!0})},this.handleAddTag=e=>{const t=this.formRef.current,{modelName:s}=this.props,{version:i}=this.props.modelVersion;this.setState({isTagsRequestPending:!0}),this.props.setModelVersionTagApi(s,i,e.name,e.value).then((()=>{this.setState({isTagsRequestPending:!1}),t.resetFields()})).catch((e=>{this.setState({isTagsRequestPending:!1}),console.error(e),x.Ay.error(this.props.intl.formatMessage({id:"IWuVOI",defaultMessage:"Failed to add tag. Error: {userVisibleError}"},{userVisibleError:e.getUserVisibleError()}))}))},this.handleSaveEdit=e=>{let{name:t,value:s}=e;const{modelName:i}=this.props,{version:o}=this.props.modelVersion;return this.props.setModelVersionTagApi(i,o,t,s).catch((e=>{console.error(e),x.Ay.error(this.props.intl.formatMessage({id:"HNLDYl",defaultMessage:"Failed to set tag. Error: {userVisibleError}"},{userVisibleError:e.getUserVisibleError()}))}))},this.handleDeleteTag=e=>{let{name:t}=e;const{modelName:s}=this.props,{version:i}=this.props.modelVersion;return this.props.deleteModelVersionTagApi(s,i,t).catch((e=>{console.error(e),x.Ay.error(this.props.intl.formatMessage({id:"Ay+ZP/",defaultMessage:"Failed to delete tag. Error: {userVisibleError}"},{userVisibleError:e.getUserVisibleError()}))}))},this.renderAliasEditor=()=>{var e,t;const s=this.props.modelVersion.version,i=(null===(e=this.props.modelEntity)||void 0===e||null===(t=e.aliases)||void 0===t?void 0:t.filter((e=>{let{version:t}=e;return t===s})).map((e=>{let{alias:t}=e;return t})))||[];return(0,y.Y)(T.K.Item,{label:this.props.intl.formatMessage({id:"HzGYm5",defaultMessage:"Aliases"}),children:(0,y.Y)(G,{aliases:i,version:this.props.modelVersion.version,modelEntity:this.props.modelEntity,onAliasesModified:this.props.onAliasesModified})},"description-key-aliases")}}componentDidMount(){const e=`${this.props.modelName} v${this.props.modelVersion.version} - MLflow Model`;M.A.updatePageTitle(e)}shouldHideDeleteOption(){return!1}renderStageDropdown(e){const{handleStageTransitionDropdownSelect:t}=this.props;return(0,y.Y)(T.K.Item,{label:this.props.intl.formatMessage({id:"IHyeUr",defaultMessage:"Stage"}),children:e.status===w.IP.READY?(0,y.Y)(C,{currentStage:e.current_stage,permissionLevel:e.permission_level,onSelect:t}):w.$0[e.current_stage]},"description-key-stage")}renderDisabledStage(e){const t=(0,y.Y)(g.A,{id:"gIc8Lp",defaultMessage:"Stages have been deprecated in the new Model Registry UI. Learn how to  migrate models <link>here</link>.",values:{link:e=>(0,y.Y)(c.o.Link,{href:P.pG,openInNewTab:!0,children:e})}});return(0,y.Y)(T.K.Item,{label:this.props.intl.formatMessage({id:"paQ2Wc",defaultMessage:"Stage (deprecated)"}),children:(0,y.FD)("div",{css:W,children:[w.QQ[e.current_stage],(0,y.Y)(S.paO,{title:t,placement:"bottom",children:(0,y.Y)(S.mo0,{css:Q})})]})},"description-key-stage-disabled")}renderRegisteredTimestampDescription(e){return(0,y.Y)(T.K.Item,{label:this.props.intl.formatMessage({id:"+1i81u",defaultMessage:"Registered At"}),children:M.A.formatTimestamp(e)},"description-key-register")}renderCreatorDescription(e){return e&&(0,y.Y)(T.K.Item,{label:this.props.intl.formatMessage({id:"5Mzn2b",defaultMessage:"Creator"}),children:e},"description-key-creator")}renderLastModifiedDescription(e){return(0,y.Y)(T.K.Item,{label:this.props.intl.formatMessage({id:"o7dzKo",defaultMessage:"Last Modified"}),children:M.A.formatTimestamp(e)},"description-key-modified")}renderSourceRunDescription(){return(0,y.Y)(T.K.Item,{label:this.props.intl.formatMessage({id:"+LLlvi",defaultMessage:"Source Run"}),className:"linked-run",children:this.resolveRunLink()},"description-key-source-run")}renderCopiedFromLink(){const{source:e}=this.props.modelVersion;if(!e||!/^models:\/[^/]+\/[^/]+$/.test(e))return null;const t=e.split("/"),s=t[1],i=t[2],o=(0,y.FD)(y.FK,{children:[(0,y.Y)(l.N_,{"data-test-id":"copied-from-link",to:d.fM.getModelVersionPageRoute(s,i),children:s}),"\xa0",(0,y.Y)(g.A,{id:"1RxxTj",defaultMessage:"(Version {sourceModelVersion})",values:{sourceModelVersion:i}})]});return(0,y.Y)(T.K.Item,{label:this.props.intl.formatMessage({id:"oZReP2",defaultMessage:"Copied from"}),children:o},"description-key-copied-from")}getDescriptions(e){const{usingNextModelsUI:t}=this.props;return[this.renderRegisteredTimestampDescription(e.creation_timestamp),this.renderCreatorDescription(e.user_id),this.renderLastModifiedDescription(e.last_updated_timestamp),this.renderSourceRunDescription(),this.renderCopiedFromLink(),t?this.renderAliasEditor():this.renderStageDropdown(e),t?this.renderDisabledStage(e):null].filter((e=>null!==e))}renderMetadata(e){return(0,y.Y)(T.K,{className:"metadata-list",children:this.getDescriptions(e)})}renderStatusAlert(){const{status:e,status_message:t}=this.props.modelVersion;if(e!==w.IP.READY){const s=w.zA[e],i=e===w.IP.FAILED_REGISTRATION?"error":"info";return(0,y.Y)(S.FcD,{type:i,className:`status-alert status-alert-${i}`,message:t||s,icon:w.UA[e],banner:!0})}return null}renderDescriptionEditIcon(){return(0,y.FD)(c.B,{componentId:"codegen_mlflow_app_src_model-registry_components_modelversionview.tsx_516","data-test-id":"descriptionEditButton",type:"link",onClick:this.startEditingDescription,children:[(0,y.Y)(g.A,{id:"Ik96R6",defaultMessage:"Edit"})," "]})}resolveRunLink(){const{modelVersion:e,runInfo:t}=this.props;if(e.run_link)return(0,y.Y)("a",{target:"_blank",href:e.run_link,children:this.resolveRunName()});if(t){var s;let e=null;const i=null===(s=this.props.modelVersion)||void 0===s?void 0:s.source;return i&&(e=function(e,t){var s;return null===(s=e.match(new RegExp(`/${t}/artifacts/(.+)`)))||void 0===s?void 0:s[1]}(i,t.runUuid)),(0,y.Y)(l.N_,{to:F.h.getRunPageRoute(t.experimentId,t.runUuid,e),children:this.resolveRunName()})}return null}resolveRunName(){const{modelVersion:e,runInfo:t,runDisplayName:s}=this.props;return e.run_link?e.run_link.substr(0,37)+"...":t?s||t.runUuid:null}renderPomoteModelButton(){const{modelVersion:e,usingNextModelsUI:t,navigate:s}=this.props;return t?(0,y.Y)(A,{modelVersion:e}):null}getPageHeader(e,t){const s=[{id:"delete",itemName:(0,y.Y)(g.A,{id:"4+RPaz",defaultMessage:"Delete"}),onClick:this.showDeleteModal,disabled:w.jI.includes(this.props.modelVersion.current_stage)}];return(0,y.FD)(O.z,{title:e,breadcrumbs:t,children:[!this.shouldHideDeleteOption()&&(0,y.Y)(O.o,{menu:s}),this.renderPomoteModelButton()]})}render(){const{modelName:e="",modelVersion:t,tags:s,schema:i}=this.props,{description:o}=t,{isDeleteModalVisible:r,isDeleteModalConfirmLoading:n,showDescriptionEditor:a,isTagsRequestPending:c}=this.state,p=(0,y.Y)(g.A,{id:"F16DNA",defaultMessage:"Version {versionNum}",values:{versionNum:t.version}}),h=[(0,y.Y)(l.N_,{to:d.fM.modelListPageRoute,children:(0,y.Y)(g.A,{id:"pl1bdY",defaultMessage:"Registered Models"})}),(0,y.Y)(l.N_,{"data-test-id":"breadcrumbRegisteredModel",to:d.fM.getModelPageRoute(e),children:e})];return(0,y.FD)("div",{children:[this.getPageHeader(p,h),this.renderStatusAlert(),this.renderMetadata(t),(0,K.WX)()&&(0,y.Y)("div",{css:X,children:(0,y.Y)(B.C,{})}),(0,y.Y)(q.i,{title:(0,y.FD)("span",{children:[(0,y.Y)(g.A,{id:"z9UqPZ",defaultMessage:"Description"})," ",a?null:this.renderDescriptionEditIcon()]}),forceOpen:a,defaultCollapsed:!o,"data-test-id":"model-version-description-section",children:(0,y.Y)(L.V,{defaultMarkdown:o,onSubmit:this.handleSubmitEditDescription,onCancel:this.handleCancelEditDescription,showEditor:a})}),(0,y.Y)("div",{"data-test-id":"tags-section",children:(0,y.Y)(q.i,{title:(0,y.Y)(g.A,{id:"TlFUsN",defaultMessage:"Tags"}),defaultCollapsed:0===M.A.getVisibleTagValues(s).length,"data-test-id":"model-version-tags-section",children:(0,y.Y)($.A,{innerRef:this.formRef,handleAddTag:this.handleAddTag,handleDeleteTag:this.handleDeleteTag,handleSaveEdit:this.handleSaveEdit,tags:s,isRequestPending:c})})}),(0,y.Y)(q.i,{title:(0,y.Y)(g.A,{id:"gUdmaJ",defaultMessage:"Schema"}),"data-test-id":"model-version-schema-section",children:(0,y.Y)(I.i,{schema:i})}),(0,y.Y)(u.M,{title:this.props.intl.formatMessage({id:"98Ub01",defaultMessage:"Delete Model Version"}),visible:r,confirmLoading:n,onOk:this.handleDeleteConfirm,okText:this.props.intl.formatMessage({id:"ICtiKS",defaultMessage:"Delete"}),okType:"danger",onCancel:this.hideDeleteModal,cancelText:this.props.intl.formatMessage({id:"zMhOr3",defaultMessage:"Cancel"}),children:(0,y.Y)("span",{children:(0,y.Y)(g.A,{id:"88l+j9",defaultMessage:"Are you sure you want to delete model version {versionNum}? This cannot be undone.",values:{versionNum:t.version}})})})]})}}const J={setModelVersionTagApi:r.Id,deleteModelVersionTagApi:r.nZ},ee=(0,o.Ng)(((e,t)=>{const{modelName:s}=t,{version:i}=t.modelVersion;return{tags:(0,a.hs)(s,i,e)}}),J)((0,U.p)((0,V.Ay)(Z)));var te=s(61661),se=s(5911),ie=s(66273),oe=s(47061),re=s(84254),ne=s(13804),ae=s(2893),le=s(72066),de=s(28976);class ce extends i.Component{constructor(){super(...arguments),this.listTransitionRequestId=void 0,this.pollIntervalId=void 0,this.initGetModelVersionDetailsRequestId=(0,f.yk)(),this.getRunRequestId=(0,f.yk)(),this.updateModelVersionRequestId=(0,f.yk)(),this.transitionModelVersionStageRequestId=(0,f.yk)(),this.getModelVersionDetailsRequestId=(0,f.yk)(),this.initGetMlModelFileRequestId=(0,f.yk)(),this.state={criticalInitialRequestIds:[this.initGetModelVersionDetailsRequestId,this.initGetMlModelFileRequestId]},this.pollingRelatedRequestIds=[this.getModelVersionDetailsRequestId,this.getRunRequestId],this.hasPendingPollingRequest=()=>this.pollingRelatedRequestIds.every((e=>{const t=this.props.apis[e];return Boolean(t&&t.active)})),this.loadData=e=>{const t=[this.getModelVersionDetailAndRunInfo(e)];return Promise.all([t])},this.pollData=()=>{const{modelName:e,version:t,navigate:s}=this.props;return!this.hasPendingPollingRequest()&&M.A.isBrowserTabVisible()?this.loadData().catch((i=>{"RESOURCE_DOES_NOT_EXIST"===i.getErrorCode()?(M.A.logErrorAndNotifyUser(i),this.props.deleteModelVersionApi(e,t,void 0,!0),s(d.fM.getModelPageRoute(e))):console.error(i)})):Promise.resolve()},this.handleStageTransitionDropdownSelect=(e,t)=>{const{modelName:s,version:i}=this.props,o=e.to_stage;e.type===w.$p.APPLIED_TRANSITION&&this.props.transitionModelVersionStageApi(s,i.toString(),o,t,this.transitionModelVersionStageRequestId).then(this.loadData).catch(M.A.logErrorAndNotifyUser)},this.handleEditDescription=e=>{const{modelName:t,version:s}=this.props;return this.props.updateModelVersionApi(t,s,e,this.updateModelVersionRequestId).then(this.loadData).catch(console.error)},this.loadModelDataWithAliases=()=>{this.props.getRegisteredModelApi(this.props.modelName)}}getModelVersionDetailAndRunInfo(e){const{modelName:t,version:s}=this.props;return this.props.getModelVersionApi(t,s,!0===e?this.initGetModelVersionDetailsRequestId:this.getModelVersionDetailsRequestId).then((e=>{let{value:t}=e;t&&!t[(0,re.zL)("model_version")].run_link&&this.props.getRunApi(t[(0,re.zL)("model_version")].run_id,this.getRunRequestId)}))}getModelVersionMlModelFile(){const{modelName:e,version:t}=this.props;this.props.getModelVersionArtifactApi(e,t).then((s=>this.props.parseMlModelFile(e,t,s.value,this.initGetMlModelFileRequestId))).catch((()=>{this.setState((e=>({criticalInitialRequestIds:h().without(e.criticalInitialRequestIds,this.initGetMlModelFileRequestId)})))}))}componentDidMount(){this.loadData(!0).catch(console.error),this.loadModelDataWithAliases(),this.pollIntervalId=setInterval(this.pollData,w.Gs),this.getModelVersionMlModelFile()}componentDidUpdate(e){this.props.version===e.version&&this.props.modelName===e.modelName||(this.loadData(!0).catch(console.error),this.getModelVersionMlModelFile())}componentWillUnmount(){clearInterval(this.pollIntervalId)}render(){const{modelName:e,version:t,modelVersion:s,runInfo:i,runDisplayName:o,navigate:r,schema:n,modelEntity:a}=this.props;return(0,y.Y)(ne.L,{children:(0,y.Y)(se.Ay,{requestIds:this.state.criticalInitialRequestIds,children:(l,c,u)=>{if(c){clearInterval(this.pollIntervalId);const s=M.A.getResourceConflictError(u,this.state.criticalInitialRequestIds);if(s)return(0,y.Y)(ie.E,{statusCode:409,subMessage:s.error.getMessageField(),fallbackHomePageReactRoute:d.fM.modelListPageRoute});if(M.A.shouldRender404(u,this.state.criticalInitialRequestIds))return(0,y.Y)(ie.E,{statusCode:404,subMessage:`Model ${e} v${t} does not exist`,fallbackHomePageReactRoute:d.fM.modelListPageRoute});const i=u.filter((e=>{var t;return this.state.criticalInitialRequestIds.includes(e.id)&&(null===(t=e.error)||void 0===t?void 0:t.getErrorCode())===P.tG.PERMISSION_DENIED}));var p;if(i&&i[0])return(0,y.Y)(ie.E,{statusCode:403,subMessage:this.props.intl.formatMessage({id:"bQSJKh",defaultMessage:'Permission denied for {modelName} version {version}. Error: "{errorMsg}"'},{modelName:e,version:t,errorMsg:null===(p=i[0].error)||void 0===p?void 0:p.getMessageField()}),fallbackHomePageReactRoute:d.fM.modelListPageRoute});(0,se.dD)(u)}else{if(l)return(0,y.Y)(oe.y,{});if(s)return(0,y.Y)(ee,{modelName:e,modelVersion:s,modelEntity:a,runInfo:i,runDisplayName:o,handleEditDescription:this.handleEditDescription,deleteModelVersionApi:this.props.deleteModelVersionApi,navigate:r,handleStageTransitionDropdownSelect:this.handleStageTransitionDropdownSelect,schema:n,onAliasesModified:this.loadModelDataWithAliases})}return null}})})}}const ue={getModelVersionApi:r.s5,getRegisteredModelApi:r.SY,updateModelVersionApi:r.DL,transitionModelVersionStageApi:r.tP,getModelVersionArtifactApi:r.ax,parseMlModelFile:r.qI,deleteModelVersionApi:r.TQ,getRunApi:n.aO},pe=(0,ae.h)((0,o.Ng)(((e,t)=>{const s=decodeURIComponent(t.params.modelName),{version:i}=t.params,o=(0,a.Af)(e,s,i),r=(0,a.SE)(e,s,i);let n=null;o&&!o.run_link&&(n=(0,te.K4)(o&&o.run_id,e));const l=n&&(0,te.X3)(n.runUuid,e)&&n&&M.A.getRunDisplayName(n,n.runUuid),d=e.entities.modelByName[s],{apis:c}=e;return{modelName:s,version:i,modelVersion:o,schema:r,runInfo:n,runDisplayName:l,apis:c,modelEntity:d}}),ue)((0,V.Ay)(ce))),he=(0,le.X)(de.A.mlflowServices.MODEL_REGISTRY,pe);var me=he},3645:function(e,t,s){s.d(t,{QN:function(){return u},F3:function(){return h},xH:function(){return m},BE:function(){return p}});var i=s(76998),o=s(8704),r=s(47609),n=s(34139),a=s(51391);const{Option:l,OptGroup:d}=o._vn,c="Create New Model",u=`$$$__${c}__$$$`,p="selectedModel",h="modelName";class m extends i.Component{constructor(){super(...arguments),this.state={selectedModel:null},this.handleModelSelectChange=e=>{this.setState({selectedModel:e})},this.modelNameValidator=(e,t,s)=>{const{modelByName:i}=this.props;s(i[t]?`Model "${t}" already exists.`:void 0)},this.handleFilterOption=(e,t)=>-1!==(t&&t.value||"").toLowerCase().indexOf(e.toLowerCase())}renderExplanatoryText(){const{isCopy:e}=this.props,{selectedModel:t}=this.state;if(!t||t===u)return null;const s=e?(0,a.Y)(n.A,{id:"hxMEqi",defaultMessage:"The model version will be copied to {selectedModel} as a new version.",values:{selectedModel:t}}):(0,a.Y)(n.A,{id:"zjXq2X",defaultMessage:"The model will be registered as a new version of {selectedModel}.",values:{selectedModel:t}});return(0,a.Y)("p",{className:"modal-explanatory-text",children:s})}renderModel(e){return(0,a.Y)(l,{value:e.name,children:e.name},e.name)}render(){const{modelByName:e,innerRef:t,isCopy:s}=this.props,{selectedModel:i}=this.state,n=i===u;return(0,a.FD)(o.lVW,{ref:t,layout:"vertical",className:"register-model-form",children:[(0,a.Y)(o.lVW.Item,{label:s?(0,a.Y)("b",{children:"Copy to model"}):"Model",name:p,rules:[{required:!0,message:"Please select a model or create a new one."}],children:(0,a.FD)(o._vn,{dropdownClassName:"model-select-dropdown",onChange:this.handleModelSelectChange,placeholder:"Select a model",filterOption:this.handleFilterOption,onSearch:this.props.onSearchRegisteredModels,showSearch:!0,children:[(0,a.FD)(l,{value:u,className:"create-new-model-option",children:[(0,a.Y)("i",{className:"fa fa-plus fa-fw",style:{fontSize:13}})," ",c]}),(0,a.Y)(d,{label:"Models",children:Object.values(e).map((e=>this.renderModel(e)))})]})}),n?(0,a.Y)(o.lVW.Item,{label:"Model Name",name:h,rules:[{required:!0,message:"Please input a name for the new model."},{validator:this.modelNameValidator}],children:(0,a.Y)(r.I,{placeholder:"Input a model name"})}):null,this.renderExplanatoryText()]})}}},82478:function(e,t,s){s.d(t,{i:function(){return v}});var i=s(76998),o=s(3281),r=s(69512),n=s(41648);var a=s(34139),l=s(24816),d=s(8704),c=s(51391);const{Column:u}=r.A,{Text:p}=o.o,h=2;function m(e,t){const{type:s}=e,i=" ".repeat(t*h);if("object"===s){return`${i}{\n${Object.keys(e.properties).map((s=>{const i=e.properties[s],o=i.required?"":" (optional)",r=m(i,t+1),n=(t+1)*h;return`${" ".repeat(n)}${s}: ${r.slice(n)+o}`})).join(",\n")}\n${i}}`}if("array"===s){const s=t*h;return`${i}Array(${m(e.items,t).slice(s)})`}return`${i}${s}`}function g(e){let t=!0;void 0!==e.required?({required:t}=e):void 0!==e.optional&&e.optional&&(t=!1);const s=t?(0,c.Y)(p,{bold:!0,children:"(required)"}):(0,c.Y)(p,{color:"secondary",children:"(optional)"}),i="name"in e?e.name:"-";return(0,c.FD)(p,{children:[i," ",s]})}function f(e){const t="tensor"===e.type?`Tensor (dtype: ${(s=e)["tensor-spec"].dtype}, shape: [${s["tensor-spec"].shape}])`:m(e,0);var s;return(0,c.Y)("pre",{css:D,children:t})}class M extends i.PureComponent{constructor(){super(...arguments),this.renderSchemaTable=(e,t)=>(0,c.Y)(r.A,{className:"inner-table",size:"middle",showHeader:!1,pagination:!1,locale:{emptyText:`No schema ${t}.`},dataSource:this.getSchemaRowData(e),columns:[{title:"Name",dataIndex:"name",key:"name",width:"40%"},{title:"Type",dataIndex:"type",key:"type",width:"60%"}],scroll:{y:240}}),this.getSchemaRowData=e=>{const t=[];return e.forEach(((e,s)=>{t[s]={key:s,name:g(e),type:f(e)}})),t},this.renderSectionHeader=e=>(0,c.Y)("strong",{className:"primary-text",children:e})}render(){const{schema:e}=this.props,t=e.inputs.length||e.outputs.length?[{key:"1",name:this.props.intl.formatMessage({id:"sxlGRc",defaultMessage:"Inputs ({numInputs})"},{numInputs:e.inputs.length}),type:"",table:this.renderSchemaTable(e.inputs,"inputs")},{key:"2",name:this.props.intl.formatMessage({id:"llVQ2r",defaultMessage:"Outputs ({numOutputs})"},{numOutputs:e.outputs.length}),type:"",table:this.renderSchemaTable(e.outputs,"outputs")}]:[],{theme:s}=this.props.designSystemThemeApi;return(0,c.Y)("div",{css:y(s),children:(0,c.FD)(r.A,{className:"outer-table",rowClassName:"section-header-row",size:"middle",pagination:!1,defaultExpandAllRows:this.props.defaultExpandAllRows,expandRowByClick:!0,expandedRowRender:e=>e.table,expandIcon:e=>{let{expanded:t,onExpand:s,record:i}=e;return t?(0,c.Y)("span",{onClick:e=>s(i,e),children:(0,c.Y)(d.pgH,{})}):(0,c.Y)("span",{onClick:e=>s(i,e),children:(0,c.Y)(d.Xeq,{})})},locale:{emptyText:(0,c.Y)("div",{children:(0,c.Y)(a.A,{id:"Wd8Tga",defaultMessage:"No schema. See <link>MLflow docs</link> for how to include input and output schema with your model.",values:{link:e=>(0,c.Y)("a",{href:n.zR,target:"_blank",rel:"noreferrer",children:e})}})})},dataSource:t,scroll:{x:240},children:[(0,c.Y)(u,{title:this.props.intl.formatMessage({id:"Nj6Ez5",defaultMessage:"Name"}),width:"40%",dataIndex:"name",render:this.renderSectionHeader},1),(0,c.Y)(u,{title:this.props.intl.formatMessage({id:"2f2qeb",defaultMessage:"Type"}),width:"60%",dataIndex:"type",render:this.renderSectionHeader},2)]},"schema-table")})}}const v=(0,l.Ay)((0,o.Z)(M)),b=".ant-table-middle>.ant-table-content>.ant-table-scroll>.ant-table-body>table",y=e=>({[`${b}>.ant-table-thead>tr>th.ant-table-expand-icon-th`]:{padding:"12px 0",width:"32px"},[`${b}>.ant-table-thead>tr>th.ant-table-row-cell-break-word`]:{padding:"12px 0"},[`${b}>.ant-table-tbody>tr>td.ant-table-row-cell-break-word`]:{padding:"12px 0"},[`${b}>.ant-table-tbody>tr.section-header-row>td.ant-table-row-cell-break-word`]:{padding:"0",width:"32px"},[`${b}>.ant-table-tbody>tr.section-header-row>td.ant-table-row-expand-icon-cell`]:{padding:"0"},".outer-table .ant-table-body":{overflowX:"auto !important",overflowY:"hidden"},".inner-table .ant-table-body":{overflowY:"auto !important"},".inner-table":{maxWidth:800},".outer-table":{maxWidth:800},".section-header-row":{lineHeight:"32px",cursor:"pointer"},".ant-table-tbody>tr>td":{borderColor:e.colors.borderDecorative},".ant-table-thead>tr>th":{backgroundColor:e.colors.backgroundSecondary,color:e.colors.textPrimary,borderColor:e.colors.borderDecorative},".ant-table-tbody>tr.ant-table-row:hover td":{backgroundColor:e.colors.backgroundSecondary},".ant-table-cell":{backgroundColor:e.colors.backgroundPrimary,color:e.colors.textPrimary}}),D=e=>({whiteSpace:"pre-wrap",padding:e.spacing.sm,marginTop:e.spacing.sm,marginBottom:e.spacing.sm})},99476:function(e,t,s){s.d(t,{_C:function(){return a},pc:function(){return r},so:function(){return n}});var i=s(69578),o=s(13004);function r(e){return e?`${i.Qs} ilike ${(0,o.GP)(e,!0)}`:""}function n(){let{query:e=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[],s=e.includes("tags.")?e:r(e);return s&&t.push(s),t.join(" AND ")}function a(e){return"searchInput"in e?e.searchInput:"nameSearchInput"in e&&"tagSearchInput"in e?r(e.nameSearchInput)+" AND "+e.tagSearchInput:"tagSearchInput"in e?e.tagSearchInput:"nameSearchInput"in e?e.nameSearchInput:""}}}]);
//# sourceMappingURL=55.f3c7e4a3.chunk.js.map